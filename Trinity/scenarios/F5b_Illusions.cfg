#textdomain wesnoth-Trinity

[scenario]
    id="F5b"
    name= _ "Illusions"
    map_data="{~add-ons/Trinity/maps/F5b.map}"
    next_scenario=F5b_b
    victory_when_enemies_defeated=no
    {TURNS 16 20 25}

    [music]
        name="casualties_of_war.ogg"
    [/music]

    [story]
        [part]
            story= _ "As the remnants of Haldrad's forces were disappearing into the hole, the sky was turning dark and roiling with clouds.  A violent wind picked up and tossed man and beast like litter.  Regardless of where heading into the hole took them, everyone knew staying behind was not an option."
            background="story/Trinity_maelstrom-2.jpg"
        [/part]
        [part]
            story= _ "Those who went into the hole tried to slide down the side, but violent forces pulled them away and tossed them about.  It was very disorienting and not how what one would expect falling to feel.  Eventually, each person came to a more-or-less gentle landing in an icy cavern."
            background="story/Trinity_maelstrom-2.jpg"
        [/part]
    [/story]

    #	{DEFAULT_SCHEDULE}
    [time]
        id=ice_cave
        name= _ "Ice Cave"
        image=misc/schedule-ice.png
        red=-80
        green=-60
        blue=-10
    [/time]

    {BMR_RESTORE_SIDE 1}
    #	{BMR_RESTORE_SIDE 3}

    [event]
        name=prestart
        [objectives]
            side=0
            [objective]
                condition=win
                description=_ "Defeat Enemy Leaders"
            [/objective]
            [objective]
                condition=lose
                description=_ "Death of Haldrad"
            [/objective]
            [objective]
                condition=lose
                description=_ "Death of Dardrus"
            [/objective]
        [/objectives]
        #	    [recall]
        #		id=Nemesis
        #		x,y=19,22
        #	    [/recall]
        [recall]
            id=Dardrus
            x,y=12,24
        [/recall]
	[kill]
	type=Trinity Wagon
	[/kill]
# this slows things down too much.
#        {TRINITY_BEAM 13 8}
        [item]
            image=items/sceptre-of-fire.png
            x,y=17,7
        [/item]
        [store_unit]
            [filter]
                id=Seth_il
            [/filter]
            variable=seth
            kill=yes
        [/store_unit]
    [/event]

    [side]
        type=Haldrad Fighter
        save_id=Royal
        id=Haldrad
        side=1
        canrecruit=yes
        controller=human
        fog=no
        shroud=yes
        recruit="Spearman, Bowman, Horseman,SouthSeas Seaman, SouthSeas Caster, SouthSeas Swimmer, SouthSeas Arsonist, Primevalist Fighter, Primevalist Follower"
        {GOLD 150 125 100}
        {INCOME 6 4 2}
        team_name=Primeval
    [/side]

    [side]
        type=Seth
        id=Seth_il
        name= _ "Seth"
        facing=nw
        ellipse="misc/ellipse"
        [modifications]
            {TRAIT_RESILIENT}
            {TRAIT_STRONG}
        [/modifications]
        unrenamable=yes
        side=2
        canrecruit=yes
        controller=ai
        fog=no
#ifdef EASY
        recruit=Tomb Huntress, Tomb Shade, Tomb Dancer, Tomb Guard, Spirit Dove
#endif
#ifdef NORMAL
        recruit=Tomb Huntress, Tomb Shade, Tomb Dancer, Tomb Guard, Spirit Dove, Tomb Stalker
#endif
#ifdef HARD
        recruit=Tomb Huntress, Tomb Shade, Tomb Dancer, Tomb Guard, Spirit Dove, Tomb Stalker
#endif
        {GOLD 350 425 500}
        {INCOME 5 8 11}
        team_name=Phantom
    [/side]

    [event]
        name=start
        [message]
            speaker=Haldrad
            message= _ "That was confusing...  What is this place?"
        [/message]
        [message]
            speaker=narrator
            message= _ "This scenario is not finished, though it is 'playable'."
            image="wesnoth-icon.png"
        [/message]
        #	[endlevel]
        #	{CONTINUE}
        #	[/endlevel]
    [/event]

    #	{ARCHAIC_KHTHON_RECRUITS (side=4)}

    [event]
        name=moveto
        [filter]
            side=1
            y=1-14
        [/filter]
        [remove_shroud]
            side=1
            x=6-21
            y=2-13
        [/remove_shroud]
        [message]
            speaker=unit
            message= _ "Aye, am I looking down upon the world?  We are up in the air?"
        [/message]
        [message]
            speaker=unit
            message= _ "Oh, that looks familiar!"
        [/message]
        [scroll_to]
            x,y=17,7
        [/scroll_to]
        [delay]
            time=500
        [/delay]
        [message]
            speaker=Haldrad
            message= _ "Odd that it is just sitting there...  Well, we can't just loiter up here, so we might as well pick up the sceptre."
        [/message]
    [/event]

    [event]
        name=moveto
        [filter]
            side=1
            y=14-21
        [/filter]
        [unit]
            type=SouthSeas Seadog
            name="Ponce"
            id="Ponce"
            profile="portraits/ponce.png"
            [modifications]
                {TRAIT_LOYAL}
                {TRAIT_RESILIENT}
            [/modifications]
            side=1
            x,y=6,23
        [/unit]
        {MOVE_UNIT (id=Ponce) 10 23}
        [message]
            speaker=Ponce
            message= _ "Prince!  You are walking into a trap!  This is the work of the outsider, Ishtu save us!"
        [/message]
        [message]
            speaker=Haldrad
            message= _ "Who are you?  What are you talking about?"
        [/message]
        [message]
            speaker=Ponce
            message= _ "I was a prisoner on one of your wagons.  I had been a countryman of Bresda Varden, with whom you are acquainted.  A demon imposter walked amongst you, pretending to be the winged god Ishtu.  Poor Bresda and many of her followers were fooled and tried to have those of us with clear eyes killed."
        [/message]
        [message]
            speaker=Haldrad
            message= _ "Well then, you'll be glad to know-"
        [/message]
        [message]
            speaker=Ponce
            message= _ "I know!  But though the winged demon was an imposter, I'm afraid the rest of the enemy is not!  The outsider is awakening and will destroy all.  Yet it toys with us.  I know not why."
        [/message]
        [message]
            speaker=Dardrus
            message= _ "Nemesis was not an imposter, you do not know as much as you think.  However, there is much truth to what you say."
        [/message]
        [message]
            speaker=Haldrad
            message= _ "We need to keep moving, unless either of you have a suggestion as I can actuallly act upon? ... ...  No?  Well then, let's keep moving."
        [/message]
    [/event]

    [event]
        name=moveto
        [filter]
            side=1
            x=18-24
            y=38-41
        [/filter]
        [remove_shroud]
            side=1
            x=21-26
            y=38-41
        [/remove_shroud]
    [/event]

    [event]
        name=moveto
        [filter]
            side=1
            x=17
            y=7
        [/filter]
        [unstore_unit]
            variable=seth
        [/unstore_unit]
        {MOVE_UNIT (id=Seth_il) 10 5}
        [message]
            speaker=Seth_il
            message= _ "Ha!  Lured by your shiny little trinkets..."
        [/message]
        [teleport]
            [filter]
                id=Seth_il
            [/filter]
            x,y=22,9
            animate=yes
        [/teleport]
        {MODIFY_UNIT (id=Seth_il) facing nw}
        [message]
            speaker=Seth_il
            message= _ "I could destroy you now, but I need your help..."
        [/message]
        [music]
            name="the_city_falls.ogg"
            immediate=yes
            append=no
        [/music]
        [message]
            speaker=Seth_il
            message= _ "Of course, I cannot tell you more than that!  Lights out!"
        [/message]
        [remove_item]
            x,y=13,8
        [/remove_item]
        {FADE_STEP -128 10}
        {FADE_STEP -224 10}
        [endlevel]
            {CONTINUE}
            music="the_city_falls.ogg"
        [/endlevel]
    [/event]
[/scenario]

[scenario]
    id="F5b_b"
    name= _ "Illusions II"
    map_data="{~add-ons/Trinity/maps/F5b_b.map}"
    next_scenario=Epilog_b
    victory_when_enemies_defeated=no
    {TURNS 48 36 24}

    [music]
        name="the_deep_path.ogg"
    [/music]

    [story]
        [part]
            story= _ "A cold wind blew through the halls of the ice-cave, and everyone lost consciousness."
            #        background="story/Trinity_maelstrom-2.jpg"
        [/part]
        [part]
            story= _ "When they awoke, they were in high grass under an oddly red and dark sky."
            background="story/Trinity-landscape-red.jpg"
        [/part]
    [/story]

    #	{DEFAULT_SCHEDULE}
    [time]
        id=tri_red
        name= _ "Red Sky"
        image=misc/schedule-dusk.png
        red=10
        green=-25
        blue=-30
    [/time]

    #	{BMR_RESTORE_SIDE 1}
    #	{BMR_RESTORE_SIDE 3}

    [event]
        name=prestart
        [objectives]
            side=0
            [objective]
                condition=win
                description=_ "Defeat Enemy Leaders"
            [/objective]
            [objective]
                condition=lose
                description=_ "Death of Haldrad"
            [/objective]
            [objective]
                condition=lose
                description=_ "Death of Dardrus"
            [/objective]
            note= _ "This scenario can be played, but it is not really done.  It will be revised.  Eventually."
        [/objectives]
        [recall]
            id=Dardrus
            x,y=22,28
        [/recall]
        [recall]
            id=Ponce
            x,y=22,27
        [/recall]
        [recall]
            side=1
            x,y=23,30
        [/recall]
        [recall]
            side=1
            x,y=21,29
        [/recall]

        #	{CAPTURE_VILLAGES SIDE X Y RADIUS}
        {CAPTURE_VILLAGES 2 77 7 8}
        {CAPTURE_VILLAGES 1 22 29 6}
        #	[item]
        #	image=items/sceptre-of-fire.png
        #	x,y=25,40
        #	[/item]
        [petrify]
            #	    [filter]
            id=Nemesis_il
            #	    [/filter]
        [/petrify]
        [store_unit]
            [filter]
                id=Seth_il
            [/filter]
            variable=seth
            kill=yes
        [/store_unit]
        [set_variable]
            name=a_count
            value=0
        [/set_variable]
        [set_variable]
            name=hands
            value=0
        [/set_variable]
    [/event]

    [side]
        type=Haldrad Fighter
        save_id=Royal
        id=Haldrad
        side=1
        canrecruit=yes
        controller=human
        fog=no
        shroud=no
        recruit="Spearman, Bowman, Horseman,SouthSeas Seaman, SouthSeas Caster, SouthSeas Swimmer, SouthSeas Arsonist, Primevalist Fighter, Primevalist Follower"
        {GOLD 150 125 100}
        {INCOME 6 4 2}
        team_name=Primeval
    [/side]

    [side]
        type=Trinity Echidna
        id=Echidna_il
        name= _ "Echidna"
        facing=nw
        ellipse="misc/ellipse"
        [modifications]
            {TRAIT_STRONG}
            {TRAIT_QUICK}
        [/modifications]
        unrenamable=yes
        side=2
        canrecruit=yes
        controller=ai
        fog=no
#ifdef EASY
        recruit=Yak, Ram, Timber Wolf, Horse
#endif
#ifdef NORMAL
        recruit=Yak, Ram, Timber Wolf, Horse, Ophis, Nightmare
#endif
#ifdef HARD
        recruit=Yak, Ram, Timber Wolf, Horse, Ophis, Nightmare, Pyradalon
#endif
        {GOLD 250 325 400}
        {INCOME 12 15 21}
        team_name=Khthon
    [/side]

    [side]
        type=Primeval Nemesishi
        id=Nemesis_il
        name= _ "Nemesis"
        facing=sw
        [modifications]
            {TRAIT_STRONG}
            {TRAIT_QUICK}
        [/modifications]
        side=3
        canrecruit=yes
        controller=ai
        #	{ai/aliases/stable_singleplayer.cfg}
        fog=no
        recruit=Primeval Slow, Primeval Swiftfoot, Primeval Cutter
        {GOLD 250 300 400}
        {INCOME 10 18 25}
        team_name=Khthon
    [/side]

    [side]
        type=Seth
        id=Seth_il
        name= _ "Seth"
        facing=nw
        ellipse="misc/ellipse"
        [modifications]
            {TRAIT_RESILIENT}
            {TRAIT_STRONG}
        [/modifications]
        unrenamable=yes
        side=4
        canrecruit=yes
        controller=ai
        fog=no
#ifdef EASY
        recruit=Tomb Huntress, Tomb Shade, Tomb Dancer, Tomb Guard, Spirit Dove
#endif
#ifdef NORMAL
        recruit=Tomb Huntress, Tomb Shade, Tomb Dancer, Tomb Guard, Spirit Dove, Tomb Stalker
#endif
#ifdef HARD
        recruit=Tomb Huntress, Tomb Shade, Tomb Dancer, Tomb Guard, Spirit Dove, Tomb Stalker
#endif
        {GOLD 350 425 500}
        {INCOME 10 16 21}
        team_name=Phantom
    [/side]

    [event]
        name=start
        [message]
            speaker=Haldrad
            message= _ "<i>Now what?</i>  Where are we now?"
        [/message]
        [message]
            speaker=Dardrus
            message= _ "We are nowhere, this is not happening..."
        [/message]
        [message]
            speaker=Haldrad
            message= _ "'Nowhere'?  What are you talking about?"
        [/message]
        [message]
            speaker=Dardrus
            message= _ "It doesn't matter...  I shouldn't have said anything."
        [/message]
        [message]
            x,y=21,29
            message= _ "Is that a statue?"
        [/message]
        [scroll_to]
            x,y=22,20
        [/scroll_to]
        [music]
            name=northerners.ogg
            immediate=yes
            append=no
        [/music]
        [delay]
            time=500
        [/delay]
        [message]
            speaker=Dardrus
            message= _ "I doubt it, and neither is that thing in the cave."
        [/message]
        [message]
            speaker=Echidna_il
            message= _ "You do not have that winged she-devil to hide behind anymore.  You're mine!"
        [/message]
        #	    [message]
        #		speaker=narrator
        #		message= _ "This scenario is not really finished, though it is somewhat playable."
        #		image=wesnoth-icon.png
        #	    [/message]
    [/event]

    [event]
        name=turn 2
        [message]
            speaker=Haldrad
            message= _ "I don't like our position, it's rather exposed."
        [/message]
        [message]
            speaker=Ponce
            message= _ "There is a ruin to the southwest, that might be better."
        [/message]
        [scroll_to]
            x,y=3,45
        [/scroll_to]
        [delay]
            time=800
        [/delay]
        [message]
            speaker=Haldrad
            message= _ "Right, let's go there."
        [/message]
    [/event]

    [event]
        name=turn 3
        [message]
            speaker=Echidna_il
            message= _ "I have defeated the Nemesis, I will wipe out the rest of you, and then..."
        [/message]
        [message]
            speaker=Dardrus
            message= _ "And then what?"
        [/message]
        [message]
            speaker=Echidna_il
            message= _ "I ... I - <i>Silence!</i>"
        [/message]
        #	    [message]
        #		speaker=Dardrus
        #		message= _ "(I thought so.  She is either as in the dark as we are, or she is not real.)"
        #	    [/message]
        #	    [message]
        #		speaker=Haldrad
        #		message= _ "(There you go again, what is this 'not real'?)"
        #	    [/message]
    [/event]

    [event]
        name=die
        first_time_only=no
        [filter]
            side=1
        [/filter]
        [filter_second]
            side=2
        [/filter_second]
        [if]
            [variable]
                name=a_count
                numerical_equals=2
            [/variable]
            [then]
                [message]
                    speaker=Echidna_il
                    message= _ "Ha!  I will-"
                [/message]
                {FLASH_RED ()}
                [message]
                    speaker=Echidna_il
                    message= _ "I don't feel well.  I ..."
                [/message]
                {FLASH_BLUE (
                    [kill]
                        id=Echidna_il
                        animate=yes
                    [/kill]
                    [replace_map]
                        map="{~add-ons/Trinity/maps/F5b_b-pri.map}"
                    [/replace_map]
                    [unpetrify]
                        [filter]
                            id=Nemesis_il
                        [/filter]
                    [/unpetrify]
                    [music]
                        name=suspense.ogg
                        immediate=yes
                        append=no
                    [/music]
                    {MODIFY_UNIT (side=2) side 3}
                    {TRANSFORM_UNIT (type=Yak) "Primeval Slow"}
                    {TRANSFORM_UNIT (type=Ophis) "Primeval Dogface"}
                    {TRANSFORM_UNIT (type=Ram) "Primeval Slow"}
                    {TRANSFORM_UNIT (type=Katobelpon) "Primeval Driver"}
                    {TRANSFORM_UNIT (type=Horse) "Primeval Cutter"}
                    {TRANSFORM_UNIT (type=Nightmare) "Primeval Ironwheel"}
                    {TRANSFORM_UNIT (type=Timber Wolf) "Primeval Swiftfoot"}
                    {TRANSFORM_UNIT (race=Khthon) "Primeval Striker"}
                )}
                [message]
                    speaker=Nemesis_il
                    message= "Deos arrad...  Kell, tonda e merrus."
                [/message]
                [message]
                    speaker=Haldrad
                    message= _ "What did she say?"
                [/message]
                [message]
                    speaker=Dardrus
                    message= _ "Nothing I could understand, I suspect it was nothing..."
                [/message]
                [message]
                    speaker=Haldrad
                    message= _ "(Huh?)"
                [/message]
                [message]
                    speaker=Dardrus
                    message= _ "I'd like to get a better look at my 'countrymen'."
                [/message]
            [/then]
        [/if]
        [set_variable]
            name=a_count
            add=1
        [/set_variable]
    [/event]

    [event]
        name=die
        first_time_only=no
        [filter]
            side=3
        [/filter]
        [filter_second]
            id=Dardrus
        [/filter_second]
        [if]
            [variable]
                name=a_count
                numerical_equals=3
            [/variable]
            [then]
                [message]
                    speaker=Dardrus
                    message= _ "There is something wrong with these.  They don't really fight like they should, and there is a vacantness in their eyes."
                [/message]
                [store_unit]
                    [filter]
                        id=Nemesis_il
                    [/filter]
                    variable=nemesis
                    kill=no
                [/store_unit]
                {FLASH_RED (
                    [kill]
                        id=Nemesis_il
                        animate=yes
                    [/kill]
                    [replace_map]
                        map="{~add-ons/Trinity/maps/F5b_b-dry.map}"
                    [/replace_map]
                    [unstore_unit]
                        variable=seth
                        x,y=$nemesis.x,$nemesis.y
                    [/unstore_unit]
                    [music]
                        name=weight_of_revenge.ogg
                        immediate=yes
                        append=no
                    [/music]
                    {MODIFY_UNIT (side=3) side 4}
                    {TRANSFORM_UNIT (type=Primeval Slow) "Tomb Guard"}
                    {TRANSFORM_UNIT (type=Primeval Dogface) "Tomb Sentinel"}
                    {TRANSFORM_UNIT (type=Primeval Driver) "Tomb Sentinel"}
                    {TRANSFORM_UNIT (type=Primeval Cutter) "Tomb Huntress"}
                    {TRANSFORM_UNIT (type=Primeval Ironwheel) "Tomb Archer"}
                    {TRANSFORM_UNIT (type=Primeval Swiftfoot) "Tomb Dancer"}
                    {TRANSFORM_UNIT (type=Primeval Striker) "Tomb Wing"}
                    {TRANSFORM_UNIT (
                        race=primeval
                        [not]
                            id=Dardrus
                        [/not]
                    ) "Tomb Stalker"}
                )}
                [message]
                    speaker=Seth_il
                    message= _ "Echidna and her kind had spent too much time amongst the denizens of this pathetic planet.  I needed to study her interactions with you, so I could undo the corruption."
                [/message]
                [message]
                    speaker=Haldrad
                    message= _ "Very nice, why are you telling us this?"
                [/message]
                [message]
                    speaker=Seth_il
                    message= _ "Unfortunately, much of the corruption was not caused by interaction with weaklings such as yourselves, Prince.  Rather, it was the red-eyed ones like you, Dardrus.  As you noticed, my understanding of you is not sufficient."
                [/message]
                [message]
                    speaker=Dardrus
                    message= _ "..."
                [/message]
                [message]
                    speaker=Seth_il
                    message= _ "But I will learn!"
                [/message]
                [message]
                    speaker=Haldrad
                    message= _ "I don't see a way out of this, but folding won't help."
                [/message]
            [/then]
        [/if]
        [set_variable]
            name=a_count
            add=1
        [/set_variable]
    [/event]

    [event]
        name=die
        first_time_only=no
        [filter]
            side=4
        [/filter]
        [filter_second]
            side=1
        [/filter_second]
        [if]
            [variable]
                name=a_count
                numerical_equals=8
            [/variable]
            [then]
                [message]
                    speaker=Seth_il
                    message= _ "I think I've learned all I need to learn from you..."
                [/message]
                [teleport]
                    [filter]
                        id=Seth_il
                    [/filter]
                    x,y=21,2
                    animate=yes
                [/teleport]
                [gold]
                    side=4
                    amount=200
                [/gold]
                {TRANSFORM_UNIT (id=Seth_il) "Trinity Avatar"}
                {FULL_HEAL (id=Seth_il)}
                {MODIFY_UNIT (id=Seth_il) name "Destroyer"}
                [message]
                    speaker=Haldrad
                    message= _ "(I am confused as ever.)  What happens now?"
                [/message]
                [music]
                    name=siege_of_laurelmor.ogg
                    immediate=yes
                    append=no
                [/music]
                [message]
                    speaker=Seth_il
                    message= _ "Now, you shall watch as I consume your world."
                [/message]
                [message]
                    speaker=Dardrus
                    message= _ "Gloating, huh?"
                [/message]
                {FLASH_RED (
                    [message]
                        speaker=Seth_il
                        message= _ "I do not gloat..."
                    [/message]
                    [sound]
                        name=explosion.ogg
                    [/sound]
                )}
                [message]
                    speaker=Haldrad
                    message= _ "What can we do?"
                [/message]
            [/then]
        [/if]
        [if]
            [variable]
                name=a_count
                numerical_equals=12
            [/variable]
            [then]
                # 'a_set' is to set trigger points so that 'a_count' can  continue to advance and be checked every turn, without triggering or skipping events
                [set_variable]
                    name=a_set
                    value=2
                [/set_variable]
            [/then]
        [/if]
        [set_variable]
            name=a_count
            add=1
        [/set_variable]
    [/event]

    [event]
        name=new turn
        first_time_only=no
        [if]
            [variable]
                name=a_set
                numerical_equals=2
            [/variable]
            [then]
                [set_variable]
                    name=a_set
                    add=1
                [/set_variable]
                {FLASH_RED (
                    [message]
                        speaker=Seth_il
                        message= "Rhokara!  Xhitclen noctotel?"
                    [/message]
                    [sound]
                        name=explosion.ogg
                    [/sound]
                )}
                [message]
                    speaker=Haldrad
                    message= _ "What?"
                [/message]
                [message]
                    speaker=Seth_il
                    message= "Tempak eh ..."
                [/message]
                [role]
                    role=patsy
                    type=Tomb Guard, Tomb Dancer, Tomb Huntress
                [/role]
                [message]
                    speaker=Seth_il
                    message= "Akrah!"
                [/message]
                {FLASH_RED (
                    [message]
                        role=patsy
                        message= "Grahh!"
                    [/message]
                    [sound]
                        name=explosion.ogg
                    [/sound]
                    [kill]
                        role=patsy
                        animate=yes
                    [/kill]
                )}
                [message]
                    speaker=Dardrus
                    message= _ "Insanity!  I wish I knew whether it was part of the vile plan or not."
                [/message]
                [message]
                    speaker=Haldrad
                    message= _ "History has it that the Ruby caused our earlier kings to go insane, until it was shielded by the Sceptre.  Maybe the evil spirits are weak to this as well?"
                [/message]
                {TRANSFORM_UNIT (
                    [and]
                        side=4
                    [/and]
                    [and]
                        level=1
                    [/and]
                ) "Trinity Flame"}
                {TRANSFORM_UNIT (
                    [and]
                        side=4
                    [/and]
                    [and]
                        level=2
                    [/and]
                ) "Trinity Whirl"}
                {TRANSFORM_UNIT (
                    [and]
                        side=4
                    [/and]
                    [and]
                        level=3
                    [/and]
                ) "Trinity Whirl"}
                {TRANSFORM_UNIT (id=Seth_il) "Trinity Avatar2"}
                [unit]
                    side=4
                    type=Trinity Claw
                    id=Right Hand
                    name= _ "Right Hand"
                    [modifications]
                        {TRAIT_STRONG}
                    [/modifications]
                    x,y=17,1
                    facing=sw
                [/unit]
                [unit]
                    side=4
                    type=Trinity Claw
                    id=Left Hand
                    name= _ "Left Hand"
                    [modifications]
                        {TRAIT_QUICK}
                    [/modifications]
                    x,y=25,1
                    facing=se
                [/unit]
                [set_recruit]
                    side=4
                    recruit=""
                [/set_recruit]
                [music]
                    name=gathering_storm.ogg
                    immediate=yes
                    append=no
                [/music]
            [/then]
        [/if]
    [/event]

    [event]
        name=new turn
        first_time_only=no
        [if]
            [variable]
                name=a_set
                numerical_equals=3
            [/variable]
            [then]
                [set_variable]
                    name=a_set
                    add=1
                [/set_variable]
                {FLASH_RED (
                    [message]
                        speaker=Seth_il
                        message= "Anahka hanoctenah ... Grrr ..."
                    [/message]
                    [sound]
                        name=explosion.ogg
                    [/sound]
                )}
                [message]
                    speaker=Ponce
                    message= _ "I hear a voice, in my head."
                [/message]
                [message]
                    speaker=Haldrad
                    message= _ "I hear it too!  It sounds familiar...  What does it mean?"
                [/message]
                #		[endlevel]
                #		{CONTINUE}
                #		[/endlevel]
            [/then]
        [/if]
    [/event]

    [event]
        name=last breath
        [filter]
            id=Haldrad
        [/filter]
        [message]
            speaker=Haldrad
            message= _ "Oh, what a world..."
        [/message]
        [endlevel]
            result=defeat
        [/endlevel]
    [/event]

    [event]
        name=die
        [filter]
            id=Dardrus
        [/filter]
        [message]
            speaker=Haldrad
            message= _ "I have no credibility with the winged one, Dardrus was my only hope..."
        [/message]
        [endlevel]
            result=defeat
        [/endlevel]
    [/event]


    #	[event]
    #	name=die
    #	    [filter]
    #		type=Trinity Whirl
    #	    [/filter]
    #	    [message]
    #		speaker=Haldrad
    #		message= _ "At least we know the little things can be killed, but what about the big thing?"
    #	    [/message]
    #	[/event]

    # when there are only three Whirls left, the Avatar starts to flash or something...
    # #ifdef __UNUSED__
    [event]
        name=die
        first_time_only=no
        [filter]
            type=Trinity Whirl, Trinity Flame
        [/filter]
        [kill]
            x,y=$x1,$y1
        [/kill]
        [if]
            [have_unit]
                type=Trinity Whirl, Trinity Flame
                count=5
            [/have_unit]
            [then]
                [object]
                    [filter]
                        id=Seth_il
                    [/filter]
                    silent=yes
                    [effect]
                        apply_to=image_mod
                        replace=CS(10,-15,-15)
                        #			replace=~CS(10,-15,-15)~BL(3)
                    [/effect]
                [/object]
                [object]
                    [filter]
                        id=Seth_il
                    [/filter]
                    silent=yes
                    [effect]
                        apply_to=image_mod
                        replace=BL(3)
                    [/effect]
                [/object]
                [message]
                    speaker=Dardrus
                    message= _ "The, uh, mother storm doesn't look so healthy..."
                [/message]
                [scroll_to_unit]
                    id=Seth_il
                [/scroll_to_unit]
                [delay]
                    time=1300
                [/delay]
                [message]
                    speaker=Haldrad
                    message= _ "Does killing the little things weaken it?  Maybe we can do this, we can dispatch the vile vapor?"
                [/message]
                [message]
                    speaker=Ponce
                    message= _ "Can we be so lucky?  We are not gods, can we really manage?  (I should not think such thoughts.)"
                [/message]
                [replace_map]
                    map="{~add-ons/Trinity/maps/F5b_b-ice.map}"
                [/replace_map]
                [object]
                    [filter]
                        id=Right Hand
                    [/filter]
                    silent=yes
                    [effect]
                        apply_to=image_mod
                        replace=BL(3)
                    [/effect]
                    [effect]
                        apply_to=resistance
                        replace=true
                        [resistance]
                            pierce=100
                            blade=100
                            impact=100
                            arcane=100
                            cold=100
                            fire=100
                        [/resistance]
                    [/effect]
                [/object]
                [object]
                    [filter]
                        id=Left Hand
                    [/filter]
                    silent=yes
                    [effect]
                        apply_to=image_mod
                        replace=BL(3)
                    [/effect]
                    [effect]
                        apply_to=resistance
                        replace=true
                        [resistance]
                            pierce=100
                            blade=100
                            impact=100
                            arcane=100
                            cold=100
                            fire=100
                        [/resistance]
                    [/effect]
                [/object]
            [/then]
        [/if]
    [/event]
    # #endif

    [event]
        name=die
        first_time_only=no
        [filter]
            type=Trinity Claw
        [/filter]
        [set_variable]
            name=hands
            add=1
        [/set_variable]
    [/event]

    [event]
        name=new turn
        first_time_only=no
        [if]
            [variable]
                name=hands
                greater_than=1
            [/variable]
            [then]
                {FLASH_RED (
                    [message]
                        speaker=Seth_il
                        message= "Nacoxtl!  Tecnihorus impxin ..."
                    [/message]
                )}
                [message]
                    speaker=Ponce
                    message= _ "Have we defeated it?  Have we done the work of gods!?"
                [/message]
                [message]
                    speaker=Dardrus
                    message= _ "I hope so, though I'd hesitate to think of us as gods."
                [/message]
                [message]
                    speaker=Haldrad
                    message= _ "Are we really up in the air?  Are we going to crash?  How do we get home ..."
                [/message]
                {FADE_TO_BLACK}
                [endlevel]
                    {CONTINUE}
                [/endlevel]
            [/then]
        [/if]
    [/event]

#ifdef __UNUSED__
    # this doesn't fire, who knows why?
    [event]
        name=die
        first_time_only=no
        [filter]
            type=Trinity Whirl
        [/filter]
        [kill]
            x,y=$x1,$y1
        [/kill]
        [if]
            [have_unit]
                type=Trinity Whirl
                count=1-99
            [/have_unit]
            [else]
                {FLASH_RED ()}
                [message]
                    speaker=Seth_il
                    message= _ "..."
                [/message]
                {FLASH_RED (
                    [unit]
                        id=Caldera_il
                        side=4
                        type=Battle Queen
                        name="Caldera"
                        x,y=1,15
                    [/unit]
                    [unit]
                        side=4
                        type=Javelineer
                        x,y=1,14
                    [/unit]
                    [unit]
                        side=4
                        type=Knight
                        x,y=1,16
                    [/unit]
                )}
                [message]
                    speaker=Caldera_il
                    message= _ "Haldrad!  My Son!  I have the Sceptre!  We can save the Kindom!"
                [/message]
                [message]
                    speaker=Haldrad
                    message= _ "...  What?"
                [/message]
                [message]
                    speaker=Dardrus
                    message= _ "(How does it know?)  Prince, surely you can see what that is?"
                [/message]
                [message]
                    speaker=Caldera_il
                    message= _ "My words are broken, I know, I have been a prisoner.  But now I can change events.  Not all is as it appears - just let me kill your master, and we will be free."
                [/message]
                [message]
                    speaker=Dardrus
                    message= _ "Prince, don't be fooled."
                [/message]
                [message]
                    speaker=Ponce
                    message= _ "The Outsider is weak and trying to deceive us!"
                [/message]
            [/else]
        [/if]
    [/event]

    [event]
        name=new turn
        first_time_only=no
        [if]
            [have_unit]
                id=Caldera_il
            [/have_unit]
            [then]
                [set_variable]
                    name=o_recruit
                    rand=Horseman,Knight,Spearman,Pikeman,Cavalryman,Dragoon
                [/set_variable]
                [unit]
                    side=4
                    type=$o_recruit
                    x,y=1,12
                [/unit]
            [/then]
        [/if]
    [/event]

    [event]
        name=die
        [filter]
            id=Caldera_il
        [/filter]
        [message]
            speaker=Haldrad
            message= _ "Dardrus, you were right.  This is not real, but it was an attempt by the Enemy to use us."
        [/message]
        [message]
            speaker=Dardrus
            message= _ "To be honest, I was not sure this was not real.  But, yes, this is not real.  Know this, don't let the Outsider fool you, and we shall be free."
        [/message]
        {FLASH_RED ()}
        [message]
            speaker=Seth_il
            message= "Nacoxtl!  Tecnihorus impxin ..."
        [/message]
        [message]
            speaker=Ponce
            message= _ "The voices are getting very loud!"
        [/message]
        {FADE_TO_BLACK}
        [endlevel]
            {CONTINUE}
        [/endlevel]
    [/event]
#endif

    # a catch-all
    # that works too well, put another filter
    [event]
        name=fooby
        #	name=new turn
        first_time_only=no
        [if]
            [have_unit]
                type=Trinity Claw
            [/have_unit]
            [else]
                {FLASH_RED ()}
                [message]
                    speaker=Seth_il
                    message= _ "..."
                [/message]
                {FLASH_RED ()}
                [message]
                    speaker=Dardrus
                    message= _ "The voices are getting very loud!"
                [/message]
                [message]
                    speaker=Haldrad
                    message= _ "What?  You'll need to speak up!  The voices are deafening!"
                [/message]
                {FADE_TO_BLACK}
                [endlevel]
                    {CONTINUE}
                [/endlevel]
            [/else]
        [/if]
    [/event]

    [event]
        name=time over
        [music]
            name=the_deep_path.ogg
            immediate=yes
        [/music]
        [message]
            speaker=Keldan_a
            message= _ "I sense something..."
        [/message]
        [message]
            speaker=Echidna_a
            message= _ "I know what this is, scatter!"
        [/message]
        [message]
            speaker=narrator
            message= _ "The air turned dark and thick."
            image=wesnoth-icon.png
        [/message]
        {FADE_STEP_RGB -32 -20 -10 5}
        {FADE_STEP_RGB -64 -40 -20 5}
        {FADE_STEP_RGB -96 -60 -30 5}
        {FADE_STEP_RGB -128 -80 -40 5}
        {FADE_STEP_RGB -160 -100 -50 5}
        {FADE_STEP_RGB -192 -120 -60 5}
        [kill]
            side=2
        [/kill]
        [kill]
            side=4
        [/kill]
        [kill]
            side=5
        [/kill]
        [redraw][/redraw]
        [message]
            speaker=Haldrad
            message= _ "What is happening?"
        [/message]
        [message]
            speaker=Bresda
            message= _ "I don't know!"
        [/message]
        [endlevel]
            result=defeat
        [/endlevel]
    [/event]
[/scenario]
